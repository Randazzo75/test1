import pika

print("Collegamento a RabbitMQ..............")

param = pika.ConnectionParameters(host="localhost")
connessione = pika.BlockingConnection(parameters=param)
canale = connessione.channel()

canale.queue_declare(queue="worker_q")
print("eseguito")
i=0
while True:
    messaggio = str(i)
    i += 1
    canale.basic_publish(exchange="",routing_key="worker_q",body=messaggio)
    print("Inviato %s" % messaggio)
    if i>100000:
        break

connessione.close()


