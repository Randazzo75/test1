import pika

print("Collegamento a RabbitMQ..............")

param = pika.ConnectionParameters(host="localhost")
connessione = pika.BlockingConnection(parameters=param)
canale = connessione.channel()

canale.queue_declare(queue="worker_q")
print("eseguito")

def callback(ch,method,properties,body):
    print("Ricevuto %s" % body)

canale.basic_consume(callback,queue="worker_q",no_ack=True)
canale.start_consuming()




